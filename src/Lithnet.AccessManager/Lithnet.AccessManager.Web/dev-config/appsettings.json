{
  "Authentication": {
    "Mode": "Iwa",
    "AllowedPrincipals": [
      "S-1-5-21-639624971-2667923174-1539603190-1122",
      "S-1-1-0"
    ],
    "Iwa": {
      "AuthenticationSchemes": "Negotiate"
    },
    "Oidc": {
      "Authority": "bla",
      "ClientID": "bla",
      "ResponseType": "code id_token",
      "Secret": {
        "Data": "AQAAANCMnd8BFdERjHoAwE/Cl+sBAAAAdhNjubD4kkq8Uc+M4qAbsAQAAAACAAAAAAADZgAAwAAAABAAAACXSugKRVL1iUXLjpcpb3UqAAAAAASAAACgAAAAEAAAAOz+2cbdzgG/CVPyy0GUY8QQAAAAIx7m+qAiAxxXPV//jNv4NxQAAADzkx5L0fwTQHGcM6wTGU95rp/3+A==",
        "Salt": "YYC5EJWKatpjtADZDcfk+GtgiGDodimASZNyGn9WCRRnPOwXZWY2x8PeP7Ugl00Z6kUbfNYpTfHq5ITwJsu0KYOI8V4pFbGQvMGo5p7Dz8WklflDMvQxOIldwi5BxGlzZ6AwrtKxea5qyu48p36bj0h7Jc1LmZncWSqfjNXC8xs=",
        "Mode": 1
      },
      "ClaimName": "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/upn",
      "IdpLogout": true,
      "Scopes": [
        "profile",
        "openid"
      ]
    },
    "WsFed": {
      "Metadata": "bla",
      "Realm": "bla",
      "ClaimName": "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/upn",
      "IdpLogout": true
    },
    "ClientCert": {
      "RequiredEkus": [],
      "ValidationMethod": "SpecificIssuer",
      "RequireSmartCardLogonEku": true,
      "TrustedIssuers": [
        "MIIFuzCCA6OgAwIBAgIQHPb7xayGZLBEu50kG9zPYDANBgkqhkiG9w0BAQsFADAaMRgwFgYDVQQDEw9Nb25hc2hVbmlEMS1SQ0EwHhcNMjAwMTIyMDIwODI1WhcNNDAwMTIyMDIxODI0WjAaMRgwFgYDVQQDEw9Nb25hc2hVbmlEMS1SQ0EwggIiMA0GCSqGSIb3DQEBAQUAA4ICDwAwggIKAoICAQC8uSpa3S1RAELD4Z81AM+cTTmfw1uCwAJ8qDObiL2Fsu+Htk+KqcfeDB7bp3lI1677DN3iFI2BXOdvTNhYVtFhD2dDMWdt2EPM5L1vUoo1Nvg9NAkP3Y3mz2YWXYixWFEHcXXSuuuifcP3AvOFw/nk3w5XBHTts8NoeB028ovuWV9WWtD/opjNk0sx66qlVQza5D5HM7aA0PeDVMUtArwYyKBiMQRmYc8NdX5UFrshcpE/6zMXhKmroVnL4k9b3m28WOqUsS8Go1Wxdsx/VSR7Yqhtx9sJYnmEeXG6SwzHiD2xsPcCiGAszp5oaBnoWIlQYrcHP0n3+0cNMqSuRxF3tlZSYu5L1oRLb0f7nRZA+Rs0oEeU66LEaXS6dzvTyoL5DFNqgtfrauB0FsGjjLFx7cAAdfPEBK3vNyq/PkKbWxkZgLsXJ6Gl1GLc3mjwiusaoFSa6g6nMSUKRInlyyXhEsjDRvGbl6hlqRrETt8km0brSdIaSx2h2sWl+9KmBWSn9H9E48pgS6T6VGtII3FMOPRgykxwSN1q++IX2z+R94NR+ul+nyn8MgnVHv6ODC8HaKfl0zZw+3LZna4NLjXZGmqH5RCk1EP0eSSQuv1Ozh/qGObZ4a3lt0S/8xG9aPkf7idKDhYfb/VdVBIV3ZOTvcvbCLIYYRxqOfBrHHkoQQIDAQABo4H8MIH5MAsGA1UdDwQEAwIBhjASBgNVHRMBAf8ECDAGAQH/AgEBMB0GA1UdDgQWBBTYqc/WbQW6gQHi6E9dEuToNIxMJzAQBgkrBgEEAYI3FQEEAwIBADCBpAYDVR0gBIGcMIGZMIGWBiMqhkiG9xQBvkCTeoK+OoKME4OLCYGRIILnCIa3lTqDzpdyAzBvMDoGCCsGAQUFBwICMC4eLABMAGUAZwBhAGwAIABQAG8AbABpAGMAeQAgAFMAdABhAHQAZQBtAGUAbgB0MDEGCCsGAQUFBwIBFiVodHRwOi8vcGtpLWQxLm1vbmFzaC5lZHUvcGtpL2Nwcy5odG1sMA0GCSqGSIb3DQEBCwUAA4ICAQCED9CXixoYOmx5p7QeTHq9cLCBMCntIPISPenTA14pwaV26ygrUumHF6jdIf8OyvVlKv70965VgA2262vUO9SZ7jZP2a+t4T0EKvIt2fRz4QRJ1G4IIyVQvFvl66pF3IVGRzHhd4LijViPTPjLliuZjXppJwAwU8nEcQ06eK/lm1KYM0G2FGMphyWJNCfJQS1+ox/mZ5i2MfVRNuAEqhk5VYn5YRxtecMWR4burynoJXmYR+58nH1z+QoPsrLdY9trcfQ0nR7tcqJRRRJW0zDT1POo36IwSAOhzWXxL2agdBUMLLB3AGxlOirmL7U979jZ6BJrEYH9KqvM8rlSIi9GDIM07xUWaBsauLyn9fe56Judze5C+f3DVQmS1xP1WKy3anRqTV8PlPCLRcglJT+0+5giPkXin9zS6i/ZRD/c9gbxHW0PHJVYCWkACd1d4zR4mQsyfuC8PgwJbOs+JNqrVN4bPFUld16+35SkaxicpHV50+rkMc1ugQH/zI7aXcyIk/XbiXigoVpmpKX+gPEtnNgRc3BESxs+hNJSr0AFbnYxQNwIrLFbdlygRJy7lasWIAIJDT/RJJ1cdi1CIKjkUCfbaf/Nh0v1AaLK0IYUgYBfjBFkaj8LH6K6eyfTUFC/JmbfCu3xZ4AnRTOFTai3BxSAMhgqJc+GERVlXHe5Zg=="
      ]
    }
  },
  "Authorization": {
    "AuthorizationServerMapping": [
      {
        "Domain": "idmdev1.local",
        "DisableLocalFallback": false,
        "DoNotRequireS4U": false,
        "Servers": [
          {
            "Name": "doesntexist.idmdev1.local",
            "Type": "Default"
          },
          {
            "Name": "idmd1ad1.idmdev1.local",
            "Type": "Default"
          },
          {
            "Name": "idmd1ss1.idmdev1.local",
            "Type": "Default"
          }
        ]
      }
    ],
    "Targets": [
      {
        "Id": "dde40d7b-9d97-4983-8b67-b5d19094fdbe",
        "Target": "S-1-5-21-639624971-2667923174-1539603190-3359",
        "Description": "Use a PowerShell script to determine access to PC1",
        "Type": "Computer",
        "AuthorizationMode": "PowershellScript",
        "SecurityDescriptor": "O:SYD:AR(A;;0xe00;;;S-1-5-21-639624971-2667923174-1539603190-1122)",
        "Script": "AuthZSample.ps1",
        "Jit": {
          "AuthorizingGroup": "S-1-5-21-639624971-2667923174-1539603190-3364",
          "ExpireAfter": "04:00:00"
        },
        "Laps": {
          "ExpireAfter": "01:00:00",
          "RetrievalLocation": "Auto"
        },
        "Notifications": {
          "OnFailure": [
            "fa5da8fc-3bfd-49b2-844c-9d69f5d56a1b"
          ],
          "OnSuccess": [
            "fa5da8fc-3bfd-49b2-844c-9d69f5d56a1b"
          ]
        }
      },
      {
        "Id": "9dc37cc2-45fc-4c53-a397-aa4e84012211",
        "Target": "OU=LAPS Testing,DC=EXTDEV1,DC=LOCAL",
        "Description": "Grant ryan access to LAPS testing computer in extdev1",
        "Type": "Container",
        "AuthorizationMode": "SecurityDescriptor",
        "SecurityDescriptor": "O:SYD:AR(A;;0xe00;;;S-1-5-21-639624971-2667923174-1539603190-1122)",
        "Jit": {
          "AuthorizingGroup": "S-1-5-21-639624971-2667923174-1539603190-3364",
          "ExpireAfter": "03:00:00"
        },
        "Laps": {
          "ExpireAfter": "01:30:00",
          "RetrievalLocation": "Auto"
        },
        "Notifications": {
          "OnFailure": [
            "a3a619da-effb-48e4-8e6d-7a5875bec0d3"
          ],
          "OnSuccess": [
            "a3a619da-effb-48e4-8e6d-7a5875bec0d3"
          ]
        }
      },
      {
        "Id": "e527068a-1ab0-4438-ad9b-5bd53b9753e6",
        "Target": "S-1-5-21-639624971-2667923174-1539603190-3359",
        "Description": "Grant admins access JIT access to pc1",
        "Type": "Computer",
        "AuthorizationMode": "SecurityDescriptor",
        "SecurityDescriptor": "O:SYD:AR(A;;0x800;;;BA)",
        "Jit": {
          "AuthorizingGroup": "S-1-5-21-639624971-2667923174-1539603190-3370",
          "ExpireAfter": "00:00:15"
        },
        "Laps": {
          "ExpireAfter": "02:00:00",
          "RetrievalLocation": "Auto"
        },
        "Notifications": {
          "OnFailure": [
            "email-domain-admins"
          ],
          "OnSuccess": [
            "email-domain-admins"
          ]
        }
      },
      {
        "Id": "95348587-f543-487d-a8ad-328bc3e5adcf",
        "Target": "S-1-5-21-639624971-2667923174-1539603190-3359",
        "Description": "Grant ryan full access to pc1",
        "Type": "Computer",
        "AuthorizationMode": "SecurityDescriptor",
        "SecurityDescriptor": "O:SYD:AR(A;;0xe00;;;S-1-5-21-639624971-2667923174-1539603190-1122)",
        "Jit": {
          "AuthorizingGroup": "IDMDEV1\\JIT-{computername}",
          "ExpireAfter": "02:00:00"
        },
        "Laps": {
          "ExpireAfter": "01:00:00",
          "RetrievalLocation": "Auto"
        },
        "Notifications": {
          "OnFailure": [
            "email-domain-admins"
          ],
          "OnSuccess": [
            "email-domain-admins"
          ]
        }
      },
      {
        "Id": "8648124e-c8ad-4525-968f-5691d7c4c171",
        "Target": "OU=LAPS Testing,DC=EXTDEV1,DC=LOCAL",
        "Description": "Grant ryan access to all computers in extdev1",
        "Type": "Container",
        "AuthorizationMode": "SecurityDescriptor",
        "SecurityDescriptor": "O:SYD:AR(A;;0xe00;;;S-1-5-21-639624971-2667923174-1539603190-1122)",
        "Jit": {
          "AuthorizingGroup": "EXTDEV1\\G-JIT-{computerName}",
          "ExpireAfter": "01:30:00"
        },
        "Laps": {
          "ExpireAfter": "00:00:00",
          "RetrievalLocation": "Auto"
        },
        "Notifications": {
          "OnFailure": [],
          "OnSuccess": []
        }
      },
      {
        "Id": "3708693c-29d7-4efd-bfd8-17d1512f609f",
        "Target": "DC=SUBDEV1,DC=IDMDEV1,DC=LOCAL",
        "Description": "Grant ryan access to all machines in subdev1",
        "Type": "Container",
        "AuthorizationMode": "SecurityDescriptor",
        "SecurityDescriptor": "O:SYD:AR(A;;0xe00;;;S-1-5-21-639624971-2667923174-1539603190-1122)",
        "Jit": {
          "AuthorizingGroup": "SUBDEV1\\G-JIT-{ComputerName}",
          "ExpireAfter": "01:30:00"
        },
        "Laps": {
          "ExpireAfter": "01:30:00",
          "RetrievalLocation": "Auto"
        },
        "Notifications": {
          "OnFailure": [],
          "OnSuccess": []
        }
      },
      {
        "Id": "d6e4a8a1-a82d-40f0-b3b9-0c1b986e262a",
        "Target": "DC=idmdev1,dc=local",
        "Description": "Grant domain admins access to all computers in idmdev1",
        "Type": "Container",
        "AuthorizationMode": "SecurityDescriptor",
        "SecurityDescriptor": "O:SYD:AR(A;;0xe00;;;BA)(A;;0xe00;;;S-1-5-21-639624971-2667923174-1539603190-1122)",
        "Jit": {
          "AuthorizingGroup": "EXTDEV\\G-GG-1",
          "ExpireAfter": "01:00:00"
        },
        "Laps": {
          "ExpireAfter": "01:00:00",
          "RetrievalLocation": "Auto"
        },
        "Notifications": {
          "OnFailure": [
            "email-domain-admins"
          ],
          "OnSuccess": [
            "email-domain-admins"
          ]
        }
      },
      {
        "Id": "0eb4fc0f-17f5-4603-b732-7b9b5c19ccaf",
        "Target": "S-1-5-21-639624971-2667923174-1539603190-3376",
        "Description": "Deny ryan access to laps and jit on pc2",
        "Type": "Computer",
        "AuthorizationMode": "SecurityDescriptor",
        "SecurityDescriptor": "O:SYD:AR(D;;0xe00;;;S-1-5-21-639624971-2667923174-1539603190-1122)",
        "Jit": {
          "ExpireAfter": "00:00:00"
        },
        "Laps": {
          "ExpireAfter": "00:00:00",
          "RetrievalLocation": "Auto"
        },
        "Notifications": {
          "OnFailure": [],
          "OnSuccess": []
        }
      }
    ],
    "AuthZCacheDuration": 0
  },
  "Auditing": {
    "NotificationChannels": {
      "Smtp": [
        {
          "TemplateSuccess": "EmailAuditSuccess.html",
          "TemplateFailure": "EmailAuditFailure.html",
          "EmailAddresses": [
            "laps@lithnet.local"
          ],
          "Enabled": true,
          "Id": "email-domain-admins",
          "Mandatory": false,
          "DisplayName": "Email LAPS adminstrator"
        },
        {
          "TemplateSuccess": "EmailAuditSuccess.html",
          "TemplateFailure": "EmailAuditFailure.html",
          "EmailAddresses": [
            "support@lithnet.io"
          ],
          "Enabled": true,
          "Id": "5263b7d5-0d0d-4d05-892b-40f2e98a3f72",
          "Mandatory": false,
          "DisplayName": "Email support"
        },
        {
          "TemplateSuccess": "EmailAuditSuccess.html",
          "TemplateFailure": "EmailAuditFailure.html",
          "EmailAddresses": [
            "support@lithnet.io"
          ],
          "Enabled": true,
          "Id": "a3a619da-effb-48e4-8e6d-7a5875bec0d3",
          "Mandatory": false,
          "DisplayName": "Send email to Ryan"
        }
      ],
      "Webhooks": [
        {
          "TemplateSuccess": "TeamsTemplateSuccess.json",
          "TemplateFailure": "TeamsTemplateFailure.json",
          "Url": "https://xx",
          "HttpMethod": "POST",
          "ContentType": "application/json",
          "Enabled": false,
          "Id": "teams-web-hook-da-channel",
          "Mandatory": false,
          "DisplayName": "Post to teams"
        },
        {
          "TemplateSuccess": "SlackTemplateSuccess.json",
          "TemplateFailure": "SlackTemplateFailure.json",
          "Url": "https://xx",
          "HttpMethod": "POST",
          "ContentType": "application/json",
          "Enabled": false,
          "Id": "slack-web-hook-da-channel",
          "Mandatory": false,
          "DisplayName": "Post to slack"
        },
        {
          "TemplateSuccess": "SlackTemplateSuccess.json",
          "TemplateFailure": "SlackTemplateFailure.json",
          "Url": "https://slack.com/q=Sdfsdfsdfsdfdsfdsff",
          "HttpMethod": "POST",
          "ContentType": "application/json",
          "Enabled": true,
          "Id": "127676fa-695c-40ef-a43c-a53aa5d023c4",
          "Mandatory": false,
          "DisplayName": "Post to #alerts channel in slack"
        }
      ],
      "Powershell": [
        {
          "Script": "AuditingSample.ps1",
          "TimeOut": 10,
          "Enabled": true,
          "Id": "send-to-powershell",
          "Mandatory": false,
          "DisplayName": "My script"
        },
        {
          "Script": "test-script.ps1",
          "TimeOut": 10,
          "Enabled": true,
          "Id": "3d6ca002-c40e-4622-9e18-146f5ecfc4df",
          "Mandatory": false,
          "DisplayName": "test"
        },
        {
          "Script": "AuditingSample.ps1",
          "TimeOut": 10,
          "Enabled": true,
          "Id": "a92332b1-f05d-450d-bfef-c4596cbbd825",
          "Mandatory": false,
          "DisplayName": "my really long script name goes here"
        },
        {
          "Script": "AuditingSample.ps1",
          "TimeOut": 10,
          "Enabled": true,
          "Id": "fa5da8fc-3bfd-49b2-844c-9d69f5d56a1b",
          "Mandatory": false,
          "DisplayName": "Log audit event to SIEM"
        }
      ]
    },
    "GlobalNotifications": {
      "OnFailure": [
        "email-domain-admins"
      ],
      "OnSuccess": [
        "email-domain-admins"
      ]
    }
  },
  "Email": {
    "Host": "smtp.lithnet.local",
    "Port": 25,
    "UseSsl": true,
    "UseDefaultCredentials": true,
    "Username": "username",
    "Password": {
      "Data": "AQAAANCMnd8BFdERjHoAwE/Cl+sBAAAAdhNjubD4kkq8Uc+M4qAbsAQAAAACAAAAAAADZgAAwAAAABAAAADAI0SyuDv9tSmaa7vZSelcAAAAAASAAACgAAAAEAAAALq11rMbKVnD30enSo17kCAIAAAA10rj9rg6WVIUAAAAT99lR7lrZwKiJXL/rU335rBJiNU=",
      "Salt": "dJ5oHXOzvIsBFn9ImKjQFcPIk9AzT4N5dYI82PZnxzYka9WLgwBo5xhTuWBsn52wiVMttMPxNwH0LyHZvmuwfg/+bBMUg9DsI7qjpw+FEAAVehCugKnBjTq94K4k88XAOTxlhTV126Knni9Bl5lrm+HmkzYwpUttK3xstj1YWS0=",
      "Mode": 1
    },
    "FromAddress": "laps@lithnet.local"
  },
  "RateLimits": {
    "PerIP": {
      "Enabled": true,
      "RequestsPerMinute": 5,
      "RequestsPerHour": 50,
      "RequestsPerDay": 100
    },
    "PerUser": {
      "Enabled": true,
      "RequestsPerMinute": 5,
      "RequestsPerHour": 50,
      "RequestsPerDay": 100
    }
  },
  "UserInterface": {
    "Title": "",
    "UserSuppliedReason": "Optional",
    "PhoneticSettings": {
      "CharacterMappings": {
        "a": "alpha"
      },
      "UpperPrefix": "capital",
      "GroupSize": 4,
      "HidePhoneticBreakdown": false,
      "DisableTextToSpeech": false
    }
  },
  "ForwardedHeaders": {
    "ForwardedForHeaderName": "X-FF",
    "ForwardedHostHeaderName": "X-FH",
    "ForwardedProtoHeaderName": "X-Forwarded-Proto",
    "OriginalForHeaderName": "X-Original-For",
    "OriginalHostHeaderName": "X-Original-Host",
    "OriginalProtoHeaderName": "X-Original-Proto",
    "ForwardedHeaders": "XForwardedFor",
    "ForwardLimit": 0,
    "AllowedHosts": [
      "localhost"
    ],
    "RequireHeaderSymmetry": false,
    "KnownProxies": [
      "127.0.0.1"
    ],
    "KnownNetworks": [
      "127.0.0.1/8"
    ]
  },
  "JitConfiguration": {
    "JitGroupMappings": [
      {
        "ComputerOU": "DC=IDMDEV1,DC=LOCAL",
        "Subtree": true,
        "GroupOU": "OU=JIT Groups,OU=LAPS Testing,DC=IDMDEV1,DC=LOCAL",
        "GroupNameTemplate": "JIT-{computerName}",
        "GroupType": "DomainLocal",
        "EnableJitGroupDeletion": true
      },
      {
        "ComputerOU": "OU=Computers,OU=LAPS Testing,DC=EXTDEV1,DC=LOCAL",
        "Subtree": true,
        "GroupOU": "OU=JIT Groups,OU=LAPS Testing,DC=EXTDEV1,DC=LOCAL",
        "GroupNameTemplate": "JIT-{computerName}",
        "GroupType": "DomainLocal",
        "EnableJitGroupDeletion": false
      },
      {
        "ComputerOU": "OU=LAPS Testing,DC=IDMDEV1,DC=LOCAL",
        "Subtree": false,
        "GroupOU": "OU=JIT Groups,OU=LAPS Testing,DC=EXTDEV1,DC=LOCAL",
        "GroupNameTemplate": "JIT-{computerName}",
        "GroupType": "Universal",
        "EnableJitGroupDeletion": false
      }
    ],
    "EnableJitGroupCreation": true,
    "DynamicGroupMappings": [
      {
        "GroupOU": "OU=Dynamic JIT Groups,OU=LAPS Testing,DC=IDMDEV1,DC=LOCAL",
        "Domain": "S-1-5-21-639624971-2667923174-1539603190"
      },
      {
        "GroupOU": "OU=Dynamic JIT Groups,OU=LAPS Testing,DC=SUBDEV1,DC=IDMDEV1,DC=LOCAL",
        "Domain": "S-1-5-21-1556964329-1208548194-2674838383",
        "OverrideMode": 2
      },
      {
        "GroupOU": "OU=Dynamic JIT Groups,OU=LAPS Testing,DC=EXTDEV1,DC=LOCAL",
        "Domain": "S-1-5-21-3770673863-3672484549-645336139",
        "OverrideMode": 3
      }
    ]
  },
  "Logging": {
    "IncludeScopes": true,
    "LogLevel": {
      "Default": "Trace",
      "Microsoft": "Warning",
      "Microsoft.Hosting.Lifetime": "Information"
    },
    "EventLog": {
      "LogLevel": {
        "Default": "Error",
        "Lithnet": "Information"
      }
    }
  }
}